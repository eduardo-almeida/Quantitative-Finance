1. Recursos de engenharia
Nosso modelo linear estava bom, mas é limitado. E se a interação de recursos causar alterações de preço?

2. Interações de recursos
A interação de recursos ocorre quando os efeitos dos recursos são combinados. Por exemplo, se multiplicarmos a média móvel de 14 dias e o RSI juntos, a correlação resultante é mais forte do que as características individuais, conforme visto na coluna da extrema direita. Este novo recurso se correlaciona ao alvo com um valor de 0-ponto-07, contra os valores individuais de -0-ponto-01 e 0-ponto-06.

3. Um problema com modelos lineares
Um problema com os modelos lineares é que devemos adicionar explicitamente as interações de recursos. Outros modelos que estamos prestes a usar serão capazes de aprender relações não lineares entre os recursos e os destinos. Isso inclui florestas aleatórias, aumento de gradiente e redes neurais.

4. Engenharia de recursos
Esses modelos mais complexos nos permitem projetar mais recursos, o que geralmente melhora o desempenho preditivo. Usaremos os dados de volume como um novo recurso. O volume é essencialmente não correlacionado com os movimentos do preço, mas as combinações de volume e outros recursos podem adicionar algum poder preditivo.

5. Volume
Vamos projetar alguns novos recursos usando o volume de nossos estoques. O volume é simplesmente o número de ações negociadas em um determinado período de tempo; no nosso caso, são ações negociadas por dia. O gráfico mostra o preço da AMD na parte superior e o volume diário no gráfico de barras na parte inferior.

6. Recursos de volume
Para projetar recursos a partir dos dados de volume, calcularemos as alterações percentuais. Primeiro obtemos a alteração percentual de um dia para o outro com a função pct_change do pandas, depois usamos a função SMA do talib para calcular a média móvel das alterações percentuais de volume.

7. Engenharia de recursos de data e hora
Outra oportunidade que temos para a engenharia de recursos é a partir dos datetimes em nossos DataFrames. Quase todos os dados financeiros terão uma data e hora associada, o que permite muita engenharia de recursos. Aqui, usaremos apenas o dia da semana. No entanto, você também pode adicionar recursos para o mês, o ano, o trimestre ou o número de dias decorridos desde algum evento - por exemplo, uma liberação de lucros. Para dados de hora em hora ou mais detalhados, você pode adicionar recursos para hora, minuto, segundo e assim por diante.

8. Extraindo o dia da semana
Para extrair o dia da semana de nosso datetime, podemos usar a propriedade dot-dayofweek. Isso resulta em um número de 0 a 6 para o dia da semana (0 sendo segunda-feira). Não podemos colocar esses números diretamente em nossos algoritmos, no entanto. Fazer isso levaria os classificadores a pensar que há uma relação linear entre os dias da semana, que pode não necessariamente existir.

9. Manequins
Em vez disso, usaremos a função get_dummies do pandas para simular nossas variáveis ​​do dia da semana. Isso cria uma nova coluna para cada dia da semana e atribui a ela 1 ou 0, dependendo se era esse dia da semana. Se for uma segunda-feira, a coluna fictícia 0 será 1 e todas as outras colunas 0. Isso significa que podemos inferir se é segunda-feira a partir de todas as outras colunas, exceto segunda-feira. Portanto, podemos descartar a coluna de segunda-feira, pois não é necessário. Este é o argumento drop_first na função get_dummies. Também definimos o argumento prefix para tornar os nomes das colunas um pouco mais descritivos. Quando imprimimos o novo DataFrame days_of_week, o dia da semana_1 à esquerda é terça-feira, pois deixamos as segundas-feiras, e o dia da semana_4 à direita é a sexta-feira.

10. Correlações fracas
Agora que temos nossos dias da semana e recursos de volume, podemos ver como eles estão correlacionados à variável de destino. As correlações são extremamente fracas, como visto na coluna da extrema direita do gráfico; mas lembre-se, a ideia aqui é que esses recursos fracamente correlacionados podem interagir com outros recursos para criar previsões mais fortes.

11. Projete alguns recursos!
Agora vamos projetar alguns recursos!